---
const { lang } = Astro.props;
import { useTranslations } from '../i18n/ui';

const t = useTranslations(lang);

const homeLink = lang === 'fr' ? '/fr' : '/';
const aboutLink = lang === 'fr' ? '/fr/about' : '/about';
const projectsLink = lang === 'fr' ? '/fr/projects' : '/projects';

// Logique du bouton de langue
const currentPath = Astro.url.pathname;
let otherLangLink;

if (lang === 'fr') {
    otherLangLink = currentPath.replace(/^\/fr/, '') || '/';
} else {
    otherLangLink = '/fr' + (currentPath === '/' ? '' : currentPath);
}

const otherLang = lang === 'fr' ? 'en' : 'fr';
---

<nav id="navbar" class="fixed top-0 left-0 right-0 z-50 flex justify-between items-center p-6 w-full transition-all duration-500 ease-in-out">
    <div class="w-full max-w-6xl mx-auto flex justify-between items-center px-4">
        <!-- Logo -->
        <a href={homeLink} class="text-xl font-light text-slate-600 hover:text-violet-500 transition-colors tracking-wide z-50">
            Luca<span class="text-violet-500">.</span>
        </a>
        
        <!-- Menu -->
        <div class="flex gap-3 md:gap-4 items-center text-sm z-50">
            <a href={aboutLink} class="text-slate-500 hover:text-violet-500 font-medium transition-colors px-4 py-2 rounded-full neu-shadow neu-hover">
                {t('nav.about')}
            </a>
            <a href={projectsLink} class="text-slate-500 hover:text-violet-500 font-medium transition-colors px-4 py-2 rounded-full neu-shadow neu-hover">
                {t('nav.projects')}
            </a>
            
            <a href={otherLangLink} class="uppercase font-bold text-violet-500 hover:text-violet-700 px-4 py-2 rounded-full neu-shadow neu-hover ml-2">
                {otherLang}
            </a>
        </div>
    </div>
</nav>

<script>
    const navbar = document.getElementById('navbar');
    
    window.addEventListener('scroll', () => {
        // Ajoute la classe dès qu'on défile de plus de 10px
        if (window.scrollY > 10) {
            navbar.classList.add('nav-scrolled');
        } else {
            navbar.classList.remove('nav-scrolled');
        }
    });
</script>

<style>
    #navbar {
        background: transparent;
    }

    /* 
       L'utilisation de :global() est INDISPENSABLE ici.
       Sinon Astro transforme la classe en .nav-scrolled-XyZ 
       et le JavaScript ne la trouve pas.
    */
    :global(.nav-scrolled) {
        /* Couleur Slate-100 avec 70% d'opacité pour voir à travers */
        background-color: rgba(241, 245, 249, 0.7) !important;
        
        /* Le flou (L'effet Glass) */
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
        
        /* Une petite bordure blanche semi-transparente en bas pour l'effet "glace" */
        border-bottom: 1px solid rgba(255, 255, 255, 0.4);
        
        /* Une ombre douce */
        box-shadow: 0 4px 30px rgba(0, 0, 0, 0.03);
        
        /* Réduit un peu le padding au scroll pour un effet compact */
        padding-top: 1rem !important; /* p-4 */
        padding-bottom: 1rem !important;
    }
</style>